<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout}" lang="en">
<head>
    <meta charset="UTF-8">
    <title layout:title-pattern="$LAYOUT_TITLE | $CONTENT_TITLE">User Profile</title>

</head>
<body>


<div class="container" layout:fragment="content">

    <h3>User Profile</h3>

    <h4><span th:text="${user.username}"></span></h4>
    <th:block sec:authorize="hasAuthority('ADMIN')" >
        <form th:action="@{/users/toggle-disabled}" method="post">
            <th:block th:if="${!user.disabled}">
                <button class="btn waves-effect waves-light red" type="submit" name="action">Disable User
                    <i class="material-icons left">lock_outline</i>
                </button>
            </th:block>
            <th:block th:if="${user.disabled}">
                <button class="btn waves-effect waves-light green" type="submit" name="action">Enable User
                    <i class="material-icons left">lock_open</i>
                </button>
            </th:block>
            <input type="hidden" name="id" th:value="${user.id}">
            <input type="hidden" name="admin" value="false" />
        </form>
    </th:block>
    <form th:method="post" th:if="${!isFriend}" sec:authorize="isAuthenticated()"  th:name="${user.id}" th:action="@{/users/follow}">
        <input type="hidden" name="id" th:value="${user.id}"/>
    <button class='col s12 btn btn-large waves-effect indigo'>Follow</button>
    </form>
    <div th:each="post : ${user.posts}">
        <div class="row">
    <div class="col s12 m12">
        <div class="card blue-grey darken-1">
    <div class="card-content white-text">
        <span class="card-title" th:text="${post.title}"></span>
        <blockquote th:text="${post.body}"></blockquote>
        <br/>
    </div>
    </div>
    </div>
    </div>

    <th:block th:if="${isFriend}">
        <div class="fixed-action-btn">
            <a class="btn-floating btn-large red tooltipped" data-position="left"
               th:data-title="${user.username}" th:data-id="${user.id}"
               th:data-tooltip="'Send message to '+${user.username}" onclick="createNewMessage(this)">
                <i class="fas fa-pen"></i>
            </a>
            <!--<ul>-->
            <!--<li><a class="btn-floating red"><i class="material-icons">insert_chart</i></a></li>-->
            <!--</ul>-->
        </div>
    </th:block>

    <!--<div><span th:each</div>-->


</div>

</body>
</html>